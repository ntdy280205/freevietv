<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Free Vietnamese TV</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://vjs.zencdn.net/8.5.2/video-js.css" rel="stylesheet" />
  <link href="tv.css?v=1" rel="stylesheet" />
</head>
<body>

  <!-- Player -->
  <div class="player-container" id="playerContainer">
    <video id="my-video" 
           class="video-js vjs-big-play-centered" 
           controls 
           autoplay 
           muted 
           playsinline 
           preload="auto"
           poster="images/tv247_background.png">
      <source src="https://live.fptplay53.net/fnxhd1/vtv1hd_vhls.smil/chunklist_b5000000.m3u8" type="application/x-mpegURL" />
      Vui lòng nâng cấp phiên bản trình duyệt hoặc thiết bị để có thể xem chương trình này.
    </video>
  </div>

  <!-- Danh sách kênh -->
  <div class="channel-list">
    <iframe src="channels.html" class="channel-frame" id="channelFrame"></iframe>
  </div>

  <script src="https://vjs.zencdn.net/8.5.2/video.min.js"></script>
  <script>
    const player = videojs('my-video');
    const container = document.getElementById('playerContainer');
    const channelList = document.querySelector('.channel-list');

    // hình chờ loading kênh 
    container.style.setProperty('--poster', 'url("images/tv247_background.png")');

    // Import danh sách kênh từ iframe channels.html
    window.addEventListener("message", e => {
      if (e.data && e.data.src) {
        const src = e.data.src;
        const poster = e.data.poster || '';
        if (poster) {
          player.poster(poster);
          container.style.setProperty('--poster', `url("${poster}")`);
        }
        player.src({ src, type: 'application/x-mpegURL' });
        player.play();
      }
    });

    // Cập nhật kích thước iframe khi có thay đổi trên màn hình
    const updateLayout = () => {
        if (window.innerWidth <= 768) {
            const playerHeight = container.offsetHeight;
            const windowHeight = window.innerHeight;
            const newChannelListHeight = windowHeight - playerHeight;
            channelList.style.height = `${newChannelListHeight}px`;
        } else {
            channelList.style.height = '100%';
        }
    };

    // Chạy khi tải trang và khi thay đổi kích thước màn hình
    window.onload = updateLayout;
    window.onresize = updateLayout;

  </script>
</body>
</html>
